samples$resp[harvest==6]
massloss

pdf("output/lig_differences_h4h2.pdf")

par(mfrow=c(2,2))

#differences in ligning h3-h0

      mean<-
(tapply(orig_cTIC$L[harvest==6]*(1-massloss[harvest==6]), type[harvest==6], mean)-tapply(orig_cTIC$L[harvest==0], type[harvest==0], mean))*0.01 / (tapply(massloss[harvest==6], type[harvest==6], mean) - tapply(massloss[harvest==0], type[harvest==0], mean))
      sds<-sqrt(tapply(orig_cTIC$L[harvest==6]*(1-massloss[harvest==6]), type[harvest==6], sd) + tapply(orig_cTIC$L[harvest==0], type[harvest==0], stderr)) / (tapply(massloss[harvest==6], type[harvest==6], mean) - tapply(massloss[harvest==0], type[harvest==0], mean))

      sds
      height<-mean
      error<-sds

      barplot2(height, ylim=c(min(height-error)*1.2, max(height+error)*1.2), plot.ci=TRUE, ci.u=height+error,ci.l=height-error, names.arg=typlev, 
      main="differences in lignin content (6 month - initial)", ylab="%cTIC * remaining dry mass , CI (95%)", col=colscale, tck=0.01)
      
      mean<-(tapply(orig_cTIC$C[harvest==6]*(1-massloss[harvest==6]), type[harvest==6], mean)-tapply(orig_cTIC$C[harvest==0], type[harvest==0], mean)) / (tapply(massloss[harvest==6], type[harvest==6], mean) - tapply(massloss[harvest==0], type[harvest==0], mean))
      sds<-sqrt(tapply(orig_cTIC$C[harvest==6]*(1-massloss[harvest==6]), type[harvest==6], sd) + tapply(orig_cTIC$C[harvest==0], type[harvest==0], stderr)) / (tapply(massloss[harvest==6], type[harvest==6], mean) - tapply(massloss[harvest==0], type[harvest==0], mean))
      
      height<-mean
      error<-sds

      barplot2(height, ylim=c(min(height-error)*1.2, max(height+error)*1.2), plot.ci=TRUE, ci.u=height+error,ci.l=height-error, names.arg=typlev, 
      main="differences in carbohydrate content (6 month - initial)", ylab="% cTIC * remaing dry mass, CI (95%)", col=colscale, tck=0.01)

      mean<-tapply(orig_cTIC$L[harvest==15]*(1-massloss[harvest==15]), type[harvest==15], mean)-tapply(orig_cTIC$L[harvest==6]*(1-massloss[harvest==6]), type[harvest==6], mean)/massloss[harvest==6]
      sds<-sqrt(tapply(orig_cTIC$L[harvest==15]*(1-massloss[harvest==15]), type[harvest==15], sd) + tapply(orig_cTIC$L[harvest==6], type[harvest==6], stderr))
      ci2<-CI2(sds, 4, 0.05)  
      height<-mean
      error<-ci2
      barplot2(height, ylim=c(min(height-error)*1.2, max(height+error)*1.2), plot.ci=TRUE, ci.u=height+error,ci.l=height-error, names.arg=typlev, 
      main="differences in lignin content (6 month - initial litter)", ylab="%cTIC, CI (95%)", col=colscale, tck=0.01)
      
      mean<-tapply(orig_cTIC$C[harvest==15]*(1-massloss[harvest==15]), type[harvest==15], mean)-tapply(orig_cTIC$C[harvest==6]*(1-massloss[harvest==6]), type[harvest==6], mean)
      sds<-sqrt(tapply(orig_cTIC$C[harvest==15]*(1-massloss[harvest==15]), type[harvest==15], sd) + tapply(orig_cTIC$C[harvest==6]*(1-massloss[harvest==6]), type[harvest==6], stderr))
      ci2<-CI2(sds, c(5,5,5,4), 0.05)  
      height<-mean
      error<-ci2

      mean<-tapply(orig_cTIC$C[harvest==15]*(1-massloss[harvest==15]), type[harvest==15], mean)-tapply(orig_cTIC$C[harvest==6]*(1-massloss[harvest==6]), type[harvest==6], mean)/tapply(massloss[harvest==15]-massloss[harvest==6], type, mean)
      barplot2(height, ylim=c(min(height-error)*1.2, max(height+error)*1.2), plot.ci=TRUE, ci.u=height+error,ci.l=height-error, names.arg=typlev, 
      main="differences in carbohydrate content (15 month - 2month)", ylab="%cTIC, CI (95%)", col=colscale, tck=0.01)


      sds<-sqrt(tapply(orig_cTIC$L[harvest==6]*(1-massloss[harvest==6]), type[harvest==6], sd) + tapply(orig_cTIC$L[harvest==0], type[harvest==0], stderr))
      ci2<-CI2(sds, c(4,4,4,4), 0.05)  

      height<-mean
      error<-ci2

      barplot2(height, ylim=c(min(height-error)*1.2, max(height+error)*1.2), plot.ci=TRUE, ci.u=height+error,ci.l=height-error, names.arg=typlev, 
      main="differences in lignin content (6 month - initial)", ylab="%cTIC * remaining dry mass , CI (95%)", col=colscale, tck=0.01)
      
      mean<-tapply(orig_cTIC$C[harvest==6]*(1-massloss[harvest==6]), type[harvest==6], mean)-tapply(orig_cTIC$C[harvest==0], type[harvest==0], mean)
      sds<-sqrt(tapply(orig_cTIC$C[harvest==6]*(1-massloss[harvest==6]), type[harvest==6], sd) + tapply(orig_cTIC$C[harvest==0], type[harvest==0], stderr))
      ci2<-CI2(sds, 5, 0.05)  
      height<-mean
      error<-ci2

      barplot2(height, ylim=c(min(height-error)*1.2, max(height+error)*1.2), plot.ci=TRUE, ci.u=height+error,ci.l=height-error, names.arg=typlev, 
      main="differences in carbohydrate content (6 month - initial)", ylab="% cTIC * remaing dry mass, CI (95%)", col=colscale, tck=0.01)

      mean<-tapply(orig_cTIC$L[harvest==15]*(1-massloss[harvest==15]), type[harvest==15], mean)-tapply(orig_cTIC$L[harvest==6]*(1-massloss[harvest==6]), type[harvest==6], mean)
      sds<-sqrt(tapply(orig_cTIC$L[harvest==15]*(1-massloss[harvest==15]), type[harvest==15], sd) + tapply(orig_cTIC$L[harvest==6], type[harvest==6], stderr))
      ci2<-CI2(sds, 4, 0.05)  
      height<-mean
      error<-ci2
      barplot2(height, ylim=c(min(height-error)*1.2, max(height+error)*1.2), plot.ci=TRUE, ci.u=height+error,ci.l=height-error, names.arg=typlev, 
      main="differences in lignin content (6 month - initial litter)", ylab="%cTIC, CI (95%)", col=colscale, tck=0.01)
      
      mean<-tapply(orig_cTIC$C[harvest==15]*(1-massloss[harvest==15]), type[harvest==15], mean)-tapply(orig_cTIC$C[harvest==6]*(1-massloss[harvest==6]), type[harvest==6], mean)
      sds<-sqrt(tapply(orig_cTIC$C[harvest==15]*(1-massloss[harvest==15]), type[harvest==15], sd) + tapply(orig_cTIC$C[harvest==6]*(1-massloss[harvest==6]), type[harvest==6], stderr))
      ci2<-CI2(sds, c(5,5,5,4), 0.05)  
      height<-mean
      error<-ci2

      barplot2(height, ylim=c(min(height-error)*1.2, max(height+error)*1.2), plot.ci=TRUE, ci.u=height+error,ci.l=height-error, names.arg=typlev, 
      main="differences in carbohydrate content (15 month - 2month)", ylab="%cTIC, CI (95%)", col=colscale, tck=0.01)
      

dev.off()

pdf("output/carb_differences_h4h2.pdf")


#differences in carbohydrates h4-h2

      mean<-tapply(orig_cTIC$C[harvest==15], type[harvest==15], mean)-tapply(orig_cTIC$C[harvest==2], type[harvest==2], mean)
      sds<-sqrt(tapply(orig_cTIC$C[harvest==15], type[harvest==15], sd) + tapply(orig_cTIC$C[harvest==2], type[harvest==2], sd))
      ci2<-CI2(sds, c(5,5,5,4), 0.05)  

      mean
      mean+ci2
      mean-ci2

      height<-mean
      error<-ci2

      barplot2(height, ylim=c(min(height-error)*1.2, max(height+error)*1.2), plot.ci=TRUE, ci.u=height+error,ci.l=height-error, names.arg=typlev, 
      main="differences in carbohydrate content (15 month - 2month)", ylab="%cTIC, CI (95%)", col=colscale, tck=0.01)
      text((0:3+.6)*1.2, max(height+error)*1.15, c("a", "b", "b", ""))

dev.off()
pdf("output/carb_differences_h3h0.pdf")


#differences in carbohydrates h3-h0


dev.off()

pdf("output/lig_differences_h4h3.pdf")

#differences in carbohydrates h2-h0

      mean<-tapply(orig_cTIC$C[harvest==15], type[harvest==15], mean)-tapply(orig_cTIC$C[harvest==6], type[harvest==6], mean)
      sds<-sqrt(tapply(orig_cTIC$C[harvest==15], type[harvest==15], sd) + tapply(orig_cTIC$C[harvest==6], type[harvest==6], sd))
      ci2<-CI2(sds, c(5,5,5,4), 0.05)  

      mean
      mean+
ci2
      mean-ci2

      height<-mean
      error<-ci2

      barplot2(height, ylim=c(min(height-error)*1.2, max(height+error)*1.2), plot.ci=TRUE, ci.u=height+error,ci.l=height-error, names.arg=typlev, 
      main="differences in lignin content (2 month - initial)", ylab="%cTIC, CI (95%)", col=colscale, tck=0.01)
      text(((0:3)+.6)*1.2, max(height+error)*1.15, c("a", "a", "a", "a"))

dev.off()
