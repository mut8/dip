cond<-peaks$origin=="L"|peaks$origin=="Ph"
pca_ligph<-rda(rsim[,cond], scale=T)

ord<-pca_ligph
name<-"PCA (Lignin + Phenol peaks)"
xvar<-eigenvals(ord)/sum(eigenvals(ord))

pdf("output/ligph_pca.pdf", width=7, height=14) 

par(mfrow=c(2,1))

      plot(ord, choices=c(1,2), type="n", tck=.01, 
      xlab=paste("PCA1", formatC(xvar[1]*100, digits=3), "% variance"),
      ylab=paste("PCA2", formatC(xvar[2]*100, digits=3), "% variance"))

      for (i in 1:length(typlev))
      for (j in 1:length(harlev))
      points(ord, choices=c(1,2),  display="sites", select=harvest==harlev[j] & type==typlev[i], col=colscale[j], pch=pch[i], cex=1)

      text(ord, choices=c(1,2), display="species", labels=peaks[cond,1], cex=.6)
      title(name)

legend("topright", col=colscale, pch=16, paste(levels(as.factor(samples$days)), "days"))
legend("topleft", col=1, pch=pch, typlev)


      plot(ord, choices=c(1,3), type="n", tck=.01, 
      xlab=paste("PCA1", formatC(xvar[1]*100, digits=3), "% variance"),
      ylab=paste("PCA3", formatC(xvar[3]*100, digits=3), "% variance"))

      for (i in 1:length(typlev))
      for (j in 1:length(harlev))
      points(ord, choices=c(1,3),  display="sites", select=harvest==harlev[j] & type==typlev[i], col=colscale[j], pch=pch[i], cex=1)

      text(ord, choices=c(1,3), display="species", labels=peaks[cond,1], cex=.6)
      title(name)

dev.off()

dif.pca<-rda(rsim-meaninit.rsim, scale=T)

ord<-dif.pca
name<-"diffs"
xvar<-eigenvals(ord)/sum(eigenvals(ord))

pdf("output/ligph_pca.pdf", width=7, height=14) 

par(mfrow=c(2,1))

      plot(ord, choices=c(1,2), type="n", tck=.01, 
      xlab=paste("PCA1", formatC(xvar[1]*100, digits=3), "% variance"),
      ylab=paste("PCA2", formatC(xvar[2]*100, digits=3), "% variance"))

      for (i in 1:length(typlev))
      for (j in 1:length(harlev))
      points(ord, choices=c(1,2),  display="sites", select=harvest==harlev[j] & type==typlev[i], col=colscale[j], pch=pch[i], cex=1)

      text(ord, choices=c(1,2), display="species", labels=peaks[,1], cex=.6)
      title(name)

legend("topright", col=colscale, pch=16, paste(levels(as.factor(samples$days)), "days"))
legend("topleft", col=1, pch=pch, typlev)


      plot(ord, choices=c(1,3), type="n", tck=.01, 
      xlab=paste("PCA1", formatC(xvar[1]*100, digits=3), "% variance"),
      ylab=paste("PCA3", formatC(xvar[3]*100, digits=3), "% variance"))

      for (i in 1:length(typlev))
      for (j in 1:length(harlev))
      points(ord, choices=c(1,3),  display="sites", select=harvest==harlev[j] & type==typlev[i], col=colscale[j], pch=pch[i], cex=1)

      text(ord, choices=c(1,3), display="species", labels=peaks[cond,1], cex=.6)
      title(name)

dev.off()
